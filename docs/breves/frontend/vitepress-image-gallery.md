---
title: åœ¨ VitePress ä¸­é›†æˆå›¾å†Œ
description: ä½¿ç”¨ Markdown è‡ªå®šä¹‰å®¹å™¨ï¼Œåœ¨ VitePress ä¸­å®ç°å›¾å†ŒåŠŸèƒ½
tags:
  - VitePress
  - Vue
  - è‡ªå®šä¹‰
---

# åœ¨ VitePress ä¸­åŠ å…¥å›¾å†ŒåŠŸèƒ½

VitePress çš„è®¾è®¡ç”¨é€”æ˜¯æŠ€æœ¯æ–‡æ¡£ï¼Œåšå®¢åŠŸèƒ½æ²¡æœ‰ WordPress ç­‰ CMS å¼ºå¤§ï¼Œå¯¹äºå›¾ç‰‡ä¹Ÿæ²¡æœ‰åšè¿‡å¤šç‰¹åˆ«å¤„ç†ï¼Œæ²¡æœ‰å¸¸ç”¨çš„æ”¾å¤§å’Œç›¸å†ŒåŠŸèƒ½ã€‚

ä¹‹å‰çš„æ”¾å¤§åŠŸèƒ½æˆ‘æ˜¯ç”¨ [medium-zoom](https://medium-zoom.francoischalifour.com/) å®ç°çš„ï¼Œå› ä¸ºå…¶æ˜¯ä¸ºå®Œå…¨é™æ€çš„ç½‘ç«™è®¾è®¡çš„ï¼Œåªèƒ½ä½œç”¨äºå½“å‰é¡µé¢ï¼Œæ‰€ä»¥é‡‡å–äº†ä¸€äº›[æ¯”è¾ƒè„çš„æ‰‹æ®µ](https://github.com/mark9804/blog/blob/c89a394d946145d775559db5457b0f8da10e68f7/docs/.vitepress/theme/index.mts#L23-L44)è®©å®ƒåœ¨è·¯ç”±åˆ‡æ¢æ—¶ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚

ä½†æ˜¯éšç€æˆ‘å¼€å§‹è®°å½•æ¸¸è®°ï¼Œé—®é¢˜å°±å‡ºç°äº†ã€‚æˆ‘æœ¬èº«æ˜¯ä¸€ä¸ªæ‘„å½±çˆ±å¥½è€…ï¼Œæ¯æ¬¡å‡ºè¿œé—¨åç»è¿‡ç²—ç­›çš„ç…§ç‰‡ä¸€å¤©ä¸‹æ¥æœ‰å¯èƒ½è¾¾åˆ°å°†è¿‘ 200 å¼ ï¼Œå¦‚æœå†™æ–‡ç« æ—¶æ¯å¼ å›¾éƒ½å•ç‹¬å¼€ä¸€æ®µçš„è¯æ–‡ç« å†…å®¹ä¼šæ˜¾å¾—éå¸¸å‰²è£‚ï¼Œå°ºå¯¸å æ¯”è¿‡å¤§çš„å›¾ç‰‡ä¹Ÿå¾ˆå½±å“é˜…è¯»ä½“éªŒã€‚å› æ­¤æˆ‘éœ€è¦æ·»åŠ ä¸€ä¸ªå›¾åº“åŠŸèƒ½ï¼Œè®©ä¸»é¢˜ç›¸åŒçš„å›¾ç‰‡é›†ä¸­åœ¨ä¸€èµ·æ–¹ä¾¿é˜…è¯»ã€‚

![ä»Šå¹´å¤å¤©å‡ºå›½çš„æ—¶å€™æ‹çš„ï¼Œå¼ æ•°ä¸ªä½æ•°çš„å¤©æ•°åŸºæœ¬æ˜¯å› ä¸ºæ˜¯é‚£å¤©è¦å‚åŠ å­¦ä¼š](https://cdn.sa.net/2024/11/09/lYRAJeTcD5bzXaF.jpg =128x)

### æ•ˆæœå±•ç¤º

:::gallery ç‚¼é‡‘æœ¯åšç‰©é¦†å†…éƒ¨
![](https://cdn.sa.net/2024/11/08/B6tznhbCkDWgsAE.webp)
![](https://cdn.sa.net/2024/11/08/C5XZL4M3NeUkWuA.webp)
![](https://cdn.sa.net/2024/11/08/Pzk5Y7hjS3NJ1E6.webp)
![](https://cdn.sa.net/2024/11/08/rz4AOiBUWJTFxfl.webp)
![](https://cdn.sa.net/2024/11/08/neQrdAT7BJ9DpkW.webp)
:::

[è¿™ç¯‡æ–‡ç« ](../life/view-finder-europe-prague-1) ä¸­ä¹Ÿå¤§é‡ä½¿ç”¨äº†å›¾å†ŒåŠŸèƒ½ã€‚

## å®ç°

### æ·»åŠ å›¾åº“è¯­æ³•

æˆ‘å¾ˆå–œæ¬¢ VitePress æä¾›çš„[è‡ªå®šä¹‰å®¹å™¨](https://vitepress.dev/zh/guide/markdown#custom-containers)åŠŸèƒ½ï¼Œå› æ­¤æˆ‘é€‰æ‹©äº†ä¸€ä¸ªç›¸ä¼¼çš„è¯­æ³•ä½œä¸ºå›¾åº“è¯­æ³•ï¼š

```markdown
:::gallery å›¾å†Œåç§°
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
:::
```

### æ•è·è¯­æ³•

æ¥ä¸‹æ¥éœ€è¦åœ¨ VitePress çš„è§£æé˜¶æ®µæ•è·å¹¶å¤„ç†è¿™ä¸ªè¯­æ³•ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ HTML æ¨¡æ¿ã€‚VitePress ä¼šè¿›ä¸€æ­¥å°†è¿™ä¸ªæ¨¡æ¿æ¸²æŸ“ä¸º Vue ç»„ä»¶ã€‚

é¦–å…ˆçœ‹æ•è·ã€‚VitePress ä½¿ç”¨ [markdown-it](https://github.com/markdown-it/markdown-it) ä½œä¸º Markdown è§£æå™¨ï¼Œå› æ­¤åªéœ€è¦æŒ‰ç…§ API æ–‡æ¡£æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰è§„åˆ™å³å¯ã€‚

:::code-group

```ts [.vitepress/config.ts]
export default defineConfig({
  // ...
  markdown: {
    // ...
    config: md => {
      // ...
      md.core.ruler.push("gallery", state => {
        state.tokens.forEach((token, idx) => {
          if (token?.content?.includes(":::gallery")) {
            if (state.tokens[idx].type === "fence") return; // ä¸è§£æåœ¨ä»£ç å—ä¸­çš„å›¾å†Œè¯­æ³•
            state.tokens[idx].type = "gallery";
          }
        });
        return true;
      });
    },
  },
});
```

```ts [æ•è· Token æ ·ä¾‹]
{
  type: 'inline',
  tag: '',
  attrs: null,
  map: [ 7, 10 ],
  nesting: 0,
  level: 1,
  children: [
    {
      type: 'text',
      tag: '',
      attrs: null,
      map: null,
      nesting: 0,
      level: 0,
      children: null,
      content: ':::gallery å¤§çŒªè‚˜å­',
      markup: '',
      info: '',
      meta: null,
      block: false,
      hidden: false
    },
    {
      type: 'softbreak',
      tag: 'br',
      attrs: null,
      map: null,
      nesting: 0,
      level: 0,
      children: null,
      content: '',
      markup: '',
      info: '',
      meta: null,
      block: false,
      hidden: false
    },
    {
      type: 'image',
      tag: 'img',
      attrs: [['src', 'https://example.com/image.jpg'], ['alt', 'å¤§çŒªè‚˜ğŸ¥°ğŸ¥°ğŸ¥°é¦™é¦™çš„è½¯è½¯çš„ğŸ¥°ğŸ¥°ğŸ¥°å˜¿å˜¿ğŸ¥°ğŸ¥°ğŸ¥°å·²ç»é™¤äº†å¤§çŒªè‚˜ä»¥å¤–ä»€ä¹ˆéƒ½ä¸ä¼šæƒ³äº†å‘¢ğŸ¥°ğŸ¥°ğŸ¥°']],
      map: null,
      nesting: 0,
      level: 0,
      children: [],
      content: 'å¤§çŒªè‚˜ğŸ¥°ğŸ¥°ğŸ¥°é¦™é¦™çš„è½¯è½¯çš„ğŸ¥°ğŸ¥°ğŸ¥°å˜¿å˜¿ğŸ¥°ğŸ¥°ğŸ¥°å·²ç»é™¤äº†å¤§çŒªè‚˜ä»¥å¤–ä»€ä¹ˆéƒ½ä¸ä¼šæƒ³äº†å‘¢ğŸ¥°ğŸ¥°ğŸ¥°',
      markup: '',
      info: '',
      meta: null,
      block: false,
      hidden: false
    },
    {
      type: 'softbreak',
      tag: 'br',
      attrs: null,
      map: null,
      nesting: 0,
      level: 0,
      children: null,
      content: '',
      markup: '',
      info: '',
      meta: null,
      block: false,
      hidden: false
    },
    {
      type: 'text',
      tag: '',
      attrs: null,
      map: null,
      nesting: 0,
      level: 0,
      children: null,
      content: ':::',
      markup: '',
      info: '',
      meta: null,
      block: false,
      hidden: false
    }
  ],
  content: ':::gallery å¤§çŒªè‚˜å­\n' +
    '![å¤§çŒªè‚˜ğŸ¥°ğŸ¥°ğŸ¥°é¦™é¦™çš„è½¯è½¯çš„ğŸ¥°ğŸ¥°ğŸ¥°å˜¿å˜¿ğŸ¥°ğŸ¥°ğŸ¥°å·²ç»é™¤äº†å¤§çŒªè‚˜ä»¥å¤–ä»€ä¹ˆéƒ½ä¸ä¼šæƒ³äº†å‘¢ğŸ¥°ğŸ¥°ğŸ¥°](https://example.com/image.jpg)\n' +
    ':::',
  markup: '',
  info: '',
  meta: null,
  block: true,
  hidden: false
}
```

:::

### ç”Ÿæˆ HTML æ¨¡æ¿

æ¥ä¸‹æ¥å°±æ˜¯å°±æ˜¯è®¾ç½®è§„åˆ™è§¦å‘å‡½æ•°ã€‚ç”±äºåˆšåˆšå·²ç»åŠ å…¥äº† `gallery` ç±»å‹ï¼Œå› æ­¤åªéœ€è¦åœ¨æ¸²æŸ“é˜¶æ®µæ ¹æ®ç±»å‹è°ƒç”¨å¤„ç†å‡½æ•°å³å¯ã€‚

:::code-group

```ts [config.ts] {20-22}
// ...
import { generateImgGallery } from "./utils/generateImgGallery";

export default defineConfig({
  // ...
  markdown: {
    // ...
    config: md => {
      // ...
      md.core.ruler.push("gallery", state => {
        state.tokens.forEach((token, idx) => {
          if (token?.content?.includes(":::gallery")) {
            if (state.tokens[idx].type === "fence") return; // ä¸è§£æåœ¨ä»£ç å—ä¸­çš„å›¾å†Œè¯­æ³•
            state.tokens[idx].type = "gallery";
          }
        });
        return true;
      });

      md.renderer.rules.gallery = (tokens, idx) => {
        return generateImgGallery(tokens[idx]);
      };
    },
  },
});
// ...
```

```ts [./utils/generateImgGallery.ts]
import type { Token } from "../types/Token";
import { getImgInfo } from "./generateImgComponent";

export function generateImgGallery(galleryToken: Token) {
  if (!galleryToken.children || galleryToken.children.length === 0) return "";
  const tokens = galleryToken.children;
  const galleryName = galleryToken.children[0].content
    .replace(/:::gallery\s?/, "")
    .trim();
  const imgList = tokens
    .filter(token => token.type === "image")
    .map(getImgInfo);

  return `\n<ElyImageGallery name="${galleryName}" :imgList="${JSON.stringify(
    imgList
  ).replaceAll('"', "'")}" />\n`;
}
```

```ts [./utils/generateImgComponent.ts]
import type { Token } from "../types/Token";
import type { ImageBase } from "../components/ElysiumUI/types/ImageBase";

export function getImgInfo(imgToken: Token) {
  const src = imgToken?.attrs?.find(attr => attr[0] === "src")?.[1];
  const alt = imgToken.content;
  const width = imgToken?.attrs?.find(attr => attr[0] === "width")?.[1];
  const height = imgToken?.attrs?.find(attr => attr[0] === "height")?.[1];
  return { src, alt, width, height };
}

export function generateImgComponent(imgToken: Token) {
  const { src, alt, width, height } = getImgInfo(imgToken);

  const image: ImageBase = { src, alt, width, height };

  return `<ElyImage :image="${JSON.stringify(image).replaceAll('"', "'")}" />`;
}
```

```ts [ImageBase.ts]
export type ImageBase = {
  src: string;
  alt: string;
  width?: number | string;
  height?: number | string;
};
```

:::

### æ–°å»º Vue ç»„ä»¶

æœ€åä¸€æ­¥å°±æ˜¯æ–°å»º Vue ç»„ä»¶ï¼Œå¹¶åœ¨ä¸‹ä¸€æ­¥ä¸­æŠŠå®ƒæ³¨å†Œä¸ºå…¨å±€ç»„ä»¶ã€‚

:::code-group

```vue [ImageGallery.vue]
<script setup lang="ts">
import type { ImageProps } from "./types/ImageProps";
import { parseSize } from "./_utils/styleUtils";
import { computed } from "vue";

const props = defineProps<ImageProps>();

const store = useImageStore();

const imageSrc = computed(() => {
  if (Array.isArray(props.image)) {
    return props.image[(props.index ?? 0) % props.image.length];
  }
  return props.image;
});
</script>

<template>
  <img
    class="elysium-ui elysium-ui__image cursor-pointer w-full max-w-screen-md object-contain flex-1 block"
    :src="imageSrc.src"
    :alt="imageSrc.alt"
    :style="{
      width: parseSize(imageSrc.width) ?? '100%',
      height: parseSize(imageSrc.height) ?? 'auto',
    }"
  />
</template>

<style scoped lang="scss">
img.elysium-ui__image {
  display: block;
  min-width: 0;
  max-width: 100%;
  object-fit: cover;
}
</style>
```

```ts [ImageProps.ts]
import type { ImageBase } from "./ImageBase";

export type ImageProps = {
  image: ImageBase[] | ImageBase;
  index?: number;
};
```

:::

### æ³¨å†Œå…¨å±€ç»„ä»¶

å› ä¸ºæˆ‘æ˜¯åŸºäº [Arco Design](https://arco.design/vue/docs/start) è¿›è¡Œçš„ä¸»é¢˜è‡ªå®šä¹‰ï¼Œæ‰€ä»¥æˆ‘ä¼šé¡ºå¸¦å…¨å±€å¯¼å…¥ `Tooltip` ç»„ä»¶éœ€è¦çš„ cssã€‚å¦‚æœå®Œå…¨æ˜¯è‡ªå·±å†™ç»„ä»¶åˆ™ä¸éœ€è¦è¿™ä¸€æ­¥ã€‚æˆ‘ä½¿ç”¨äº† [unplugin-auto-import](https://github.com/unplugin/unplugin-auto-import) æ’ä»¶æ¥è‡ªåŠ¨å¯¼å…¥ç»„ä»¶ï¼Œå› æ­¤åªéœ€è¦åœ¨ `enhanceApp` å‡½æ•°ä¸­æ³¨å†Œå³å¯ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨è¯¥æ’ä»¶çš„åˆ™éœ€è¦æ‰‹åŠ¨å¯¼å…¥ `Space` `Image` è¿˜æœ‰ `ImagePreviewGroup`ã€‚

:::code-group

```ts [index.ts]
// ...
import ElyImageGallery from "./components/ElysiumUI/ElyImageGallery.vue";
import "@arco-design/web-vue/es/tooltip/style/css.js";
// ...

export default {
  // ...
  enhanceApp({ app }) {
    app.component("ElyImageGallery", ElyImageGallery);
  },
};
```

:::

## ä¸€äº›å°šå¾…è§£å†³çš„å°é—®é¢˜

è‡³æ­¤å›¾åº“ç»„ä»¶åŸºæœ¬ä¸Šå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ä¸è¿‡åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­æˆ‘å‘ç°äº†ä¸€ä¸ªä¼šç¨å¾®æ¶å¿ƒåˆ°æˆ‘çš„å°é—®é¢˜ï¼Œå°±æ˜¯å®ƒä¸èƒ½æ¥å—è¿ç»­æ¢è¡Œã€‚è¿™ä¸ªéœ€è¦è¿ç»­è§£æåæ–‡æ¥è§£å†³ï¼Œä½†æ˜¯ç›®å‰å·²ç»è¶³å¤Ÿæˆ‘æ­£å¸¸ä½¿ç”¨äº†ï¼Œæ‰€ä»¥æš‚æ—¶å°±ä¸æ‰“ç®—ä¿®å¤ã€‚

```markdown
:::gallery åƒè¿™æ ·å¸¦è¿ç»­æ¢è¡Œçš„è¯­æ³•æ˜¯è¯†åˆ«ä¸äº†çš„

![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)

![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)

![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
:::

:::gallery è¿™æ ·æ˜¯èƒ½è¯†åˆ«çš„
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)
:::
```
